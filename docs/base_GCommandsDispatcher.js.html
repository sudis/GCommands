<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Source: base/GCommandsDispatcher.js</title>

    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <script src="scripts/nav.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.3/fuse.min.js"></script>
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link type="text/css" rel="stylesheet" href="styles/skyceil.css">
    <link type="text/css" rel="stylesheet" href="styles/prettify.css">
    <link type="text/css" rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.1/css/all.min.css">
</head>

<body>

<nav class="navbar">
    <div class="utilities">
        <div id="search">
            <input type="text" id="search-box" placeholder="Search"><br>
            <div id="search-results" style="display: none;"></div>
        </div>
        <button class="theme" data-theme="light"><i class="fas fa-moon"></i></button>
    </div>
    <hr>
    <h4><a href="index.html">Home</a></h4><h5 class="no-bottom must-underline">Classes</h5><ul><li><span class="small-icon C">C</span><b><a href="ButtonEvent.html">ButtonEvent</a></b><ul class="has-class-methods"><li><span class="small-icon F">F</span><a href="ButtonEvent.html#defer">defer</a></li><li><span class="small-icon F">F</span><a href="ButtonEvent.html#edit">edit</a></li><li><span class="small-icon F">F</span><a href="ButtonEvent.html#think">think</a></li></ul></li><li><span class="small-icon C">C</span><b><a href="Color.html">Color</a></b><ul class="has-class-methods"><li><span class="small-icon F">F</span><a href="Color.html#getRGB">getRGB</a></li><li><span class="small-icon F">F</span><a href="Color.html#getText">getText</a></li><li><span class="small-icon M">M</span><a href="Color.html#text">text</a></li></ul></li><li><span class="small-icon C">C</span><b><a href="GCommands.html">GCommands</a></b><ul class="has-class-methods"><li><span class="small-icon M">M</span><a href="GCommands.html#cmdDir">cmdDir</a></li><li><span class="small-icon M">M</span><a href="GCommands.html#cooldownDefault">cooldownDefault</a></li><li><span class="small-icon M">M</span><a href="GCommands.html#database">database</a></li><li><span class="small-icon M">M</span><a href="GCommands.html#eventDir">eventDir</a></li><li><span class="small-icon M">M</span><a href="GCommands.html#prefix">prefix</a></li><li><span class="small-icon M">M</span><a href="GCommands.html#slash">slash</a></li><li><span class="small-icon M">M</span><a href="GCommands.html#unkownCommandMessage">unkownCommandMessage</a></li></ul></li><li><span class="small-icon C">C</span><a href="GCommandsBase.html">GCommandsBase</a></li><li><span class="small-icon C">C</span><b><a href="GCommandsDispatcher.html">GCommandsDispatcher</a></b><ul class="has-class-methods"><li><span class="small-icon F">F</span><a href="GCommandsDispatcher.html#addInhibitor">addInhibitor</a></li><li><span class="small-icon F">F</span><a href="GCommandsDispatcher.html#awaitButtons">awaitButtons</a></li><li><span class="small-icon F">F</span><a href="GCommandsDispatcher.html#createButtonCollector">createButtonCollector</a></li><li><span class="small-icon F">F</span><a href="GCommandsDispatcher.html#getGuildPrefix">getGuildPrefix</a></li><li><span class="small-icon F">F</span><a href="GCommandsDispatcher.html#removeInhibitor">removeInhibitor</a></li><li><span class="small-icon F">F</span><a href="GCommandsDispatcher.html#setGuildPrefix">setGuildPrefix</a></li><li><span class="small-icon M">M</span><a href="GCommandsDispatcher.html#client">client</a></li></ul></li><li><span class="small-icon C">C</span><b><a href="GCommandsGuild.html">GCommandsGuild</a></b><ul class="has-class-methods"><li><span class="small-icon F">F</span><a href="GCommandsGuild.html#getCommandPrefix">getCommandPrefix</a></li><li><span class="small-icon F">F</span><a href="GCommandsGuild.html#setCommandPrefix">setCommandPrefix</a></li></ul></li><li><span class="small-icon C">C</span><b><a href="GCommandsMessage.html">GCommandsMessage</a></b><ul class="has-class-methods"><li><span class="small-icon F">F</span><a href="GCommandsMessage.html#buttons">buttons</a></li><li><span class="small-icon F">F</span><a href="GCommandsMessage.html#buttonsEdit">buttonsEdit</a></li><li><span class="small-icon F">F</span><a href="GCommandsMessage.html#buttonsWithReply">buttonsWithReply</a></li><li><span class="small-icon F">F</span><a href="GCommandsMessage.html#inlineReply">inlineReply</a></li></ul></li><li><span class="small-icon C">C</span><b><a href="GEventLoader.html">GEventLoader</a></b><ul class="has-class-methods"><li><span class="small-icon F">F</span><a href="GEventLoader.html#createAPIMessage">createAPIMessage</a></li><li><span class="small-icon F">F</span><a href="GEventLoader.html#getSlashArgs">getSlashArgs</a></li><li><span class="small-icon F">F</span><a href="GEventLoader.html#inhibit">inhibit</a></li><li><span class="small-icon M">M</span><a href="GEventLoader.html#GCommandsClient">GCommandsClient</a></li></ul></li><li><span class="small-icon C">C</span><b><a href="GEvents.html">GEvents</a></b><ul class="has-class-methods"><li><span class="small-icon M">M</span><a href="GEvents.html#eventDir">eventDir</a></li></ul></li><li><span class="small-icon C">C</span><b><a href="MessageActionRow.html">MessageActionRow</a></b><ul class="has-class-methods"><li><span class="small-icon F">F</span><a href="MessageActionRow.html#addComponent">addComponent</a></li><li><span class="small-icon F">F</span><a href="MessageActionRow.html#toJSON">toJSON</a></li></ul></li><li><span class="small-icon C">C</span><b><a href="MessageButton.html">MessageButton</a></b><ul class="has-class-methods"><li><span class="small-icon F">F</span><a href="MessageButton.html#setDisabled">setDisabled</a></li><li><span class="small-icon F">F</span><a href="MessageButton.html#setEmoji">setEmoji</a></li><li><span class="small-icon F">F</span><a href="MessageButton.html#setID">setID</a></li><li><span class="small-icon F">F</span><a href="MessageButton.html#setLabel">setLabel</a></li><li><span class="small-icon F">F</span><a href="MessageButton.html#setStyle">setStyle</a></li><li><span class="small-icon F">F</span><a href="MessageButton.html#setURL">setURL</a></li><li><span class="small-icon F">F</span><a href="MessageButton.html#toJSON">toJSON</a></li></ul></li></ul><h5 class="no-bottom must-underline">Events</h5><ul><li><span class="small-icon E">E</span><a href="GCommands.html#event:debug">debug</a></li></ul><h4>Global</h4><ul><li><a href="global.html#ReturnSystem">ReturnSystem</a></li></ul>
</nav>

<div id="main">
    <div class="burger">
        <div class="burger-line-1"></div>
        <div class="burger-line-2"></div>
        <div class="burger-line-3"></div>
    </div>

    <h1 class="page-title">Source: base/GCommandsDispatcher.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>const { Collector } = require('discord.js');
const ButtonCollectorV12 = require('../structures/v12/ButtonCollector'), ButtonCollectorV13 = require('../structures/v13/ButtonCollector')
const updater = require("../util/updater")

/**
 * The GCommansDispatcher class
 */
class GCommandsDispatcher {
    constructor(client) {

        /**
         * GCommandsDispatcher options
         * @property {Object} client
        */
        this.client = client;
        this.client.inhibitors = new Set();
    }

    /**
     * Internal method to setGuildPrefix
     * @returns {boolean}
    */
    async setGuildPrefix(prefix, guildId) {
        if(!this.client.database || !this.client.database.working) return this.client.prefix;
        if(this.client.database.type = "mongodb") {
            var guildSettings = require('../util/models/guild')

            const settings = await guildSettings.findOne({ id: guildId})
            if(!settings) {
              await guildSettings.create({
                id: guildId,
                prefix: prefix
              })

              return true;
            }

            settings.prefix = prefix
            await settings.save()
            return true;
        } else if(this.client.database.type == "sqlite") {
            this.client.database.sqlite.set(`guildPrefix_${guildId}`,prefix)
            return true;
        } else if(this.client.database.type == "mariadb") {
            this.client.database.mariadb.set(this.client.database.mariadbOptions, guildId, `guildPrefix`, prefix)
            return true;
        } else {
            console.log(new Color("&amp;d[GCommands] &amp;3Don't have database!").getText())
            return false;
        }
    }

    /**
     * Internal method to getGuildPrefix
     * @returns {Stirng}
    */
    async getGuildPrefix(guildId) {
        if(!this.client.database || !this.client.database.working) return this.client.prefix;
        if(this.client.database.type = "mongodb") {
            var guildSettings = require('../util/models/guild')

            const settings = await guildSettings.findOne({ id: guildId})
            if(!settings) {
              return this.client.prefix
            }

            return settings.prefix ? settings.prefix : this.client.prefix
        } else if(this.client.database.type == "sqlite") {
            var settings = this.client.database.sqlite.get(`guildPrefix_${guildId}`)
            return settings ? settings : this.client.prefix;
        } else if(this.client.database.type == "mariadb") {
            var settings = this.client.database.mariadb.get(this.client.database.mariadbOptions, guildId, `guildPrefix`)
            return settings ? settings : this.client.prefix;
        }
    }

    /**
     * Internal method to addInhibitor
     * @param {Function} inhibitor
     * @returns {boolean}
    */
    addInhibitor(inhibitor) {
		if(typeof inhibitor !== 'function') return console.log('&amp;d[GCommands] &amp;cThe inhibitor must be a function.');
		if(this.client.inhibitors.has(inhibitor)) return false;
		this.client.inhibitors.add(inhibitor);
		return true;
	}

    /**
     * Internal method to removeInhibitor
     * @returns {Set}
    */
    removeInhibitor(inhibitor) {
		if(typeof inhibitor !== 'function') return console.log('&amp;d[GCommands] &amp;cThe inhibitor must be a function.');
		return this.client.inhibitors.delete(inhibitor);
	}

    /**
     * Internal method to createButtonCollector
     * @param {Function} filter 
     * @param {Object} options
     * @returns {Collector}
    */
    createButtonCollector(msg, filter, options = {}) {
        if(updater.checkDjsVersion("13")) return new ButtonCollectorV13(msg, filter, options);
        else return new ButtonCollectorV12(msg, filter, options);
    }

    /**
     * Internal method to createButtonCollector
     * @param {Function} filter 
     * @param {Object} options
     * @returns {Collector}
    */
    awaitButtons(msg, filter, options = {}) {
        return new Promise((resolve, reject) => {
            const collector = this.createButtonCollector(msg, filter, options);
            collector.once('end', (buttons, reason) => {
                if (options.errors &amp;&amp; options.errors.includes(reason)) {
                    reject(buttons);
                } else {
                    resolve(buttons);
                }
            });
        })
    }
}

module.exports = GCommandsDispatcher;</code></pre>
        </article>
    </section>





</div>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 3.6.7</a> on Fri Jun 04 2021 17:16:13 GMT+0200 (stredoeurópsky letný čas) using <a href="https://github.com/devsnowflake/jsdoc-skyceil">Skyceil Theme</a>
</footer>

<script>prettyPrint();</script>
<script src="scripts/linenumber.js"></script>

</body>
</html>
